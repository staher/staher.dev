---
import { contactLinks, navItems, siteMeta } from '../data/site'
import ThemeToggle from '../components/ThemeToggle.tsx'
import '../styles/global.css'

const { title = siteMeta.title, description = siteMeta.description } = Astro.props
const pageTitle = title ?? siteMeta.title
const fullTitle =
  pageTitle && pageTitle !== siteMeta.title ? `${pageTitle} | ${siteMeta.title}` : siteMeta.title
const year = new Date().getFullYear()
const canonicalUrl = siteMeta.baseUrl
  ? new URL(Astro.url.pathname + Astro.url.search, siteMeta.baseUrl).toString()
  : undefined
const socialImage = siteMeta.socialImage?.startsWith('http')
  ? siteMeta.socialImage
  : siteMeta.baseUrl && siteMeta.socialImage
    ? new URL(siteMeta.socialImage, siteMeta.baseUrl).toString()
    : siteMeta.socialImage ?? '/og-image.png'
---

<!doctype html>
<html lang="en" data-theme="dark">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={description} />
    {canonicalUrl && <link rel="canonical" href={canonicalUrl} />}
    <meta property="og:type" content="website" />
    <meta property="og:title" content={fullTitle} />
    <meta property="og:description" content={description} />
    {canonicalUrl && <meta property="og:url" content={canonicalUrl} />}
    {socialImage && <meta property="og:image" content={socialImage} />}
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={fullTitle} />
    <meta name="twitter:description" content={description} />
    {socialImage && <meta name="twitter:image" content={socialImage} />}
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="icon" href="/favicon.ico" sizes="any" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
    <title>{fullTitle}</title>
  </head>
  <body>
    <div class="min-h-screen bg-base-200 text-base-content">
      <div class="mx-auto flex min-h-screen max-w-6xl flex-col px-4 py-8 sm:px-6 lg:px-10">
        <header class="mb-8 flex flex-col gap-4 rounded-2xl bg-base-100 p-4 shadow-sm sm:flex-row sm:items-center sm:justify-between">
          <div class="flex items-center gap-3">
            <a href="/" class="flex items-center gap-2 text-xl font-semibold tracking-tight">
              <span class="inline-flex h-10 w-10 items-center justify-center rounded-full bg-primary text-primary-content font-bold">S</span>
              <span>{siteMeta.title}</span>
            </a>
          </div>
          <nav class="flex flex-wrap justify-center gap-2 text-sm font-semibold text-base-content/80 sm:flex-1">
            {navItems.map((item) => {
              const isActive =
                item.href === '/'
                  ? Astro.url.pathname === '/'
                  : Astro.url.pathname.startsWith(item.href)

              return (
                <a
                  href={item.href}
                  class={`btn btn-sm btn-ghost ${
                    isActive ? 'btn-active text-base-content' : 'text-base-content/70'
                  }`}
                >
                  {item.label}
                </a>
              )
            })}
          </nav>
          <div class="flex items-center gap-2">
            <label class="input input-sm input-bordered hidden items-center gap-2 sm:flex">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 opacity-70" viewBox="0 0 16 16" fill="none">
                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25 2.5 2.5m-1.25-6.25A5 5 0 1 1 1.5 7.5a5 5 0 0 1 11 0Z"/>
              </svg>
              <input type="text" class="grow" placeholder="Search" />
            </label>
            <ThemeToggle client:load />
          </div>
        </header>

        <main class="flex-1 pb-16">
          <slot />
        </main>

        <footer class="footer border-t border-base-300 pt-6 text-sm text-base-content/70">
          <div class="w-full items-center justify-between gap-4 sm:flex">
            <span>Â© {year} {siteMeta.title}</span>
            <div class="flex flex-wrap gap-2">
              {contactLinks.map((link) => (
                <a href={link.href} class="btn btn-sm btn-outline">
                  {link.label}
                </a>
              ))}
            </div>
          </div>
        </footer>
      </div>
    </div>
  </body>
</html>
